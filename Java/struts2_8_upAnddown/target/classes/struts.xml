<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
        "http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

    <constant name="struts.devMode" value="true"/>

    <!-- 在这修改总文件的的大小 -->
    <constant name="struts.multipart.maxSize" value="2097152"/>
    
    <constant name="struts.custom.i18n.resources" value="i18n"/>
    
    <package name="default" namespace="/" extends="struts-default">
        <interceptors>
            <interceptor-stack name="myInterceptor">
                <interceptor-ref name="defaultStack">
                    <!-- 修改单个文件大小，Commons FileUpload 组件默认接受上传文件总的最大值为 2M -->
                    <param name="fileUpload.maximumSize">57,408</param>
                    <!-- 允许上传的文件类型 -->
                    <param name="fileUpload.allowedTypes">image/pjpeg,image/gif</param>
                    <!-- 允许上传文件的扩展名 -->
                    <param name="fileUpload.allowedExtensions">jpg,gif</param>
                </interceptor-ref>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="myInterceptor"></default-interceptor-ref>

        <action name="testUpload" class="org.pan.action.UploadAction" method="testUpload">
            <result name="success">/WEB-INF/views/success.jsp</result>
            <result name="input">/upload.jsp</result>
        </action>

        <!-- 文件下载 -->
        <action name="testDownLoad" class="org.pan.action.DownLoadAction" method="testDownLoad">
            <result type="stream">
                <!-- 文件缓冲大小 -->
                <param name="bufferSize">2048</param>
            </result>
        </action>

        <action name="testForm" class="org.pan.action.TestFormAction" method="testForm">
            <!-- 使用token 拦截器，进行表单重复提交校验 -->
            <interceptor-ref name="token"></interceptor-ref>
            <!-- 不要忘记默认的拦截器栈-->
            <interceptor-ref name="defaultStack"></interceptor-ref>

            <!-- 如果是使用的是 token 拦截器，校验失败后会转到 invalid.token -->
            <result name="invalid.token">/WEB-INF/views/token-error.jsp</result>
            <result name="success">/WEB-INF/views/success.jsp</result>
        </action>


        <!--<action name="testForm" class="org.pan.action.TestFormAction" method="testForm">-->
            <!--&lt;!&ndash; 使用tokenSession 拦截器，进行表单重复提交校验 &ndash;&gt;-->
            <!--<interceptor-ref name="tokenSession"></interceptor-ref>-->
            <!--&lt;!&ndash; 不要忘记默认的拦截器栈&ndash;&gt;-->
            <!--<interceptor-ref name="defaultStack"></interceptor-ref>-->

            <!--&lt;!&ndash; 如果是使用的是 tokenSession 拦截器，校验后会回到返回的 action方法 result。就像什么都没发生过 &ndash;&gt;-->
            <!--<result name="success">/WEB-INF/views/success.jsp</result>-->

        <!--</action>-->
    </package>

</struts>